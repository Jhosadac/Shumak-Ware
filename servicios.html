<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Servicios - Shumak Ware</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Header -->
    <header class="main-header">
        <div class="header-wrap">
            <div class="logo">
                <img src="assests/logo.png" alt="logo">
            </div>
            <nav class="nav-header">
                <ul class="main-menu">
                    <li><a href="index.html">Inicio</a></li>
                    <li><a href="habitaciones.html">Habitaciones</a></li>
                    <li><a href="restaurante.html">Restaurante</a></li>
                    <li><a href="servicios.html" class="active">Servicios</a></li>
                    <li><a href="contacto.html">Contacto</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Carrusel de Eventos -->
    <section class="events-section">
        <div class="container">
            <h2 style="color: white;">Eventos Destacados</h2>
            <div class="events-carousel">
                <div class="events-slides" id="eventsSlides">
                    <!-- Slide 1 -->
                    <div class="event-slide">
                        <div class="event-content">
                            <h3 class="event-title">Celebración de Cumpleaños</h3>
                            <p class="event-description">Organizamos las mejores fiestas de cumpleaños con decoraciones temáticas, menús personalizados y un ambiente inolvidable. Celebra tus momentos especiales con nosotros y crea recuerdos que durarán toda la vida.</p>
                            <button class="event-btn">Ver más detalles</button>
                        </div>
                    </div>
                    <!-- Slide 2 -->
                    <div class="event-slide">
                        <div class="event-content">
                            <h3 class="event-title">Bodas Inolvidables</h3>
                            <p class="event-description">Nuestro equipo de expertos en bodas se encarga de cada detalle para hacer de tu día especial una experiencia mágica. Desde la decoración floral hasta el banquete, todo está cuidadosamente planeado.</p>
                            <button class="event-btn">Ver más detalles</button>
                        </div>
                    </div>
                    <!-- Slide 3 -->
                    <div class="event-slide">
                        <div class="event-content">
                            <h3 class="event-title">Aniversarios de Oro</h3>
                            <p class="event-description">Celebra tus años de amor con una velada romántica e inolvidable. Ofrecemos paquetes exclusivos para aniversarios con cena gourmet, música en vivo y decoración especial para honrar este momento único.</p>
                            <button class="event-btn">Ver más detalles</button>
                        </div>
                    </div>
                </div>
                <div class="carousel-controls">
                    <button class="prev-btn"><i class="fas fa-chevron-left"></i></button>
                    <button class="next-btn"><i class="fas fa-chevron-right"></i></button>
                </div>
                <div class="carousel-indicators">
                    <div class="indicator-serv active" data-index="0"></div>
                    <div class="indicator-serv" data-index="1"></div>
                    <div class="indicator-serv" data-index="2"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Servicios -->
    <section class="services-section">
        <div class="container">
            <h2>Nuestros Servicios</h2>
            <div class="services-grid">
                <!-- Servicio 1 -->
                <div class="service-card">
                    <div class="service-image" style="background-image: url('https://images.unsplash.com/photo-1540575467063-178a50c2df87?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80');"></div>
                    <div class="service-content">
                        <h3 class="service-title">Cumpleaños</h3>
                        <div class="service-features">
                            <div class="feature-item">
                                <i class="fas fa-check-circle"></i>
                                <span>Decoración temática personalizada</span>
                            </div>
                            <div class="feature-item">
                                <i class="fas fa-check-circle"></i>
                                <span>Menú especial para niños y adultos</span>
                            </div>
                            <div class="feature-item">
                                <i class="fas fa-check-circle"></i>
                                <span>Animación y juegos para niños</span>
                            </div>
                            <div class="feature-item">
                                <i class="fas fa-check-circle"></i>
                                <span>Área de juegos segura</span>
                            </div>
                        </div>
                        <button class="btn-reservar" data-service="Cumpleanos">Reservar Ahora</button>
                    </div>
                </div>
                
                <!-- Servicio 2 -->
                <div class="service-card">
                    <div class="service-image" style="background-image: url('https://images.unsplash.com/photo-1580545994623-1a1d3e5f8c7f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80');"></div>
                    <div class="service-content">
                        <h3 class="service-title">Matrimonios</h3>
                        <div class="service-features">
                            <div class="feature-item">
                                <i class="fas fa-check-circle"></i>
                                <span>Ceremonia y recepción en un solo lugar</span>
                            </div>
                            <div class="feature-item">
                                <i class="fas fa-check-circle"></i>
                                <span>Menú de banquete gourmet</span>
                            </div>
                            <div class="feature-item">
                                <i class="fas fa-check-circle"></i>
                                <span>Coordinador de bodas profesional</span>
                            </div>
                            <div class="feature-item">
                                <i class="fas fa-check-circle"></i>
                                <span>Decoración floral y de ambiente</span>
                            </div>
                        </div>
                        <button class="btn-reservar" data-service="Matrimonios">Reservar Ahora</button>
                    </div>
                </div>
                
                <!-- Servicio 3 -->
                <div class="service-card">
                    <div class="service-image" style="background-image: url('https://images.unsplash.com/photo-1556912167-f556f1f39fdf?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80');"></div>
                    <div class="service-content">
                        <h3 class="service-title">Aniversarios</h3>
                        <div class="service-features">
                            <div class="feature-item">
                                <i class="fas fa-check-circle"></i>
                                <span>Cena romántica con vista especial</span>
                            </div>
                            <div class="feature-item">
                                <i class="fas fa-check-circle"></i>
                                <span>Paquete fotográfico para recuerdos</span>
                            </div>
                            <div class="feature-item">
                                <i class="fas fa-check-circle"></i>
                                <span>Brindis con vino espumante</span>
                            </div>
                            <div class="feature-item">
                                <i class="fas fa-check-circle"></i>
                                <span>Postre especial con decoración</span>
                            </div>
                        </div>
                        <button class="btn-reservar" data-service="Aniversarios">Reservar Ahora</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Modal de Reserva de Servicio -->
    <div id="reservaModal" class="modal-serv">
        <div class="modal-serv-content">
            <span class="close">&times;</span>
            <h2 id="modal-title">Reservar Servicio</h2>
            <form id="reservaForm">
                <input type="hidden" id="servicio" name="servicio">
                <div class="form-group">
                    <label for="nombre">Nombre Completo:</label>
                    <input type="text" id="nombre" name="nombre" required>
                </div>
                <div class="form-group">
                    <label for="correo">Correo Electrónico:</label>
                    <input type="email" id="correo" name="correo" required>
                </div>
                <div class="form-group">
                    <label for="telefono">Teléfono:</label>
                    <input type="tel" id="telefono" name="telefono" required>
                </div>
                <div class="form-group">
                    <label for="fecha">Fecha del Evento:</label>
                    <input type="date" id="fecha" name="fecha" required min="">
                </div>
                <div class="form-group">
                    <label for="hora_entrada">Hora de Entrada:</label>
                    <input type="time" id="hora_entrada" name="hora_entrada" required>
                </div>
                <div class="form-group">
                    <label for="hora_salida">Hora de Salida:</label>
                    <input type="time" id="hora_salida" name="hora_salida" required>
                </div>
                <button type="submit">Confirmar Reserva</button>
            </form>
        </div>
    </div>

    <!-- Modal de Confirmación -->
    <div id="confirmacionModal" class="modal-serv">
        <div class="modal-serv-content confirmation-modal">
            <span class="close">&times;</span>
            <div class="confirmation-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <h2 class="confirmation-title">¡Reserva Exitosa!</h2>
            
            <div class="confirmation-details">
                <p><strong>Servicio:</strong> <span id="conf-servicio"></span></p>
                <p><strong>Nombre:</strong> <span id="conf-nombre"></span></p>
                <p><strong>Fecha:</strong> <span id="conf-fecha"></span></p>
                <p><strong>Hora de Entrada:</strong> <span id="conf-hora-entrada"></span></p>
                <p><strong>Hora de Salida:</strong> <span id="conf-hora-salida"></span></p>
                <p><strong>Código de Reserva:</strong></p>
                <div class="confirmation-code" id="conf-codigo"></div>
            </div>
            
            <div class="payment-info">
                <h3>Instrucciones de Pago</h3>
                <p>Para confirmar tu reserva, debes realizar un pago del 25% (S/ 160) dentro de las próximas 8 horas.</p>
                <ul>
                    <li>Pago fijo: S/ 160 (por 8 horas)</li>
                    <li>Cada hora extra: S/ 25 adicionales</li>
                    <li>Máximo de personas: 30</li>
                </ul>
                <p>Después del pago, tu reserva quedará confirmada automáticamente.</p>
            </div>
            
            <a href="#" class="whatsapp-btn-serv" id="whatsappBtn">
                <i class="fab fa-whatsapp"></i> Realizar Pago por WhatsApp
            </a>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-grid">
                <div class="footer-section">
                    <h3>Acerca de Nosotros</h3>
                    <p>Shumak Ware es un hotel-restaurante campestre que combina la naturaleza con la comodidad</p>
                </div>
                <div class="footer-section">
                    <h3>Enlaces Rápidos</h3>
                    <ul>
                        <li><a href="index.html">Inicio</a></li>
                        <li><a href="habitaciones.html">Habitaciones</a></li>
                        <li><a href="restaurante.html">Restaurante</a></li>
                        <li><a href="servicios.html">Servicios</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Contacto</h3>
                    <ul>
                        <li><i class="fas fa-phone"></i> +51 912 345 678</li>
                        <li><i class="fas fa-envelope"></i> shumakware@gmail.com</li>
                        <li><i class="fas fa-map-marker-alt"></i> Anta, Huaraz, Ancash</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                &copy; 2023 Shumak Ware. Todos los derechos reservados.
            </div>
        </div>
    </footer>

    <script>
    // Configuración e inicialización de Firebase
    const firebaseConfig = {
        apiKey: "AIzaSyApq_K7pJmtrLNZcewzxaVXWnVf4Sxynv4",
        authDomain: "shumak-ware.firebaseapp.com",
        databaseURL: "https://shumak-ware-default-rtdb.firebaseio.com",
        projectId: "shumak-ware",
        storageBucket: "shumak-ware.firebasestorage.app",
        messagingSenderId: "64196160181",
        appId: "1:64196160181:web:76852cef50c12a498e6cfc",
        measurementId: "G-8L85H7B12E"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database(); // Usaremos db para referirnos a la base de datos
    // Elementos del DOM
    const eventsSlides = document.getElementById('eventsSlides');
    const eventSlides = eventsSlides.querySelectorAll('.event-slide');
    const prevBtn = document.querySelector('.prev-btn');
    const nextBtn = document.querySelector('.next-btn');
    const indicators = document.querySelectorAll('.indicator-serv');
    const reservaModal = document.getElementById('reservaModal');
    const confirmacionModal = document.getElementById('confirmacionModal');
    const reservaBtns = document.querySelectorAll('.btn-reservar');
    const closeBtns = document.querySelectorAll('.close');
    const modalTitle = document.getElementById('modal-title');
    const servicioInput = document.getElementById('servicio');
    const fechaInput = document.getElementById('fecha');
    const reservaForm = document.getElementById('reservaForm');
    const whatsappBtn = document.getElementById('whatsappBtn');
    const confServicio = document.getElementById('conf-servicio');
    const confNombre = document.getElementById('conf-nombre');
    const confFecha = document.getElementById('conf-fecha');
    const confHoraEntrada = document.getElementById('conf-hora-entrada');
    const confHoraSalida = document.getElementById('conf-hora-salida');
    const confCodigo = document.getElementById('conf-codigo');
    // Variables de estado
    let currentSlideIndex = 0;
    let codigoReserva = ""; // Ahora es let
    // Inicialización del carrusel
    function initCarousel() {
        updateSlider();
        prevBtn.addEventListener('click', () => {
            currentSlideIndex = (currentSlideIndex - 1 + eventSlides.length) % eventSlides.length;
            updateSlider();
        });
        nextBtn.addEventListener('click', () => {
            currentSlideIndex = (currentSlideIndex + 1) % eventSlides.length;
            updateSlider();
        });
        setInterval(() => {
            currentSlideIndex = (currentSlideIndex + 1) % eventSlides.length;
            updateSlider();
        }, 5000);
        indicators.forEach(indicator => {
            indicator.addEventListener('click', () => {
                currentSlideIndex = parseInt(indicator.dataset.index);
                updateSlider();
            });
        });
    }
    function updateSlider() {
        eventsSlides.style.transform = `translateX(-${currentSlideIndex * 100}%)`;
        indicators.forEach((indicator, i) => {
            indicator.classList.toggle('active', i === currentSlideIndex);
        });
    }
    // Inicialización de modales
    function initModals() {
        // Fecha mínima hoy
        fechaInput.min = new Date().toISOString().split('T')[0];
        // Abrir modal de reserva
        reservaBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const service = btn.dataset.service;
                modalTitle.textContent = `Reservar ${service}`;
                servicioInput.value = service;
                reservaModal.style.display = 'block';
            });
        });
        // Cerrar modales
        closeBtns.forEach(btn => {
            btn.addEventListener('click', closeModals);
        });
        // Cerrar al hacer clic fuera
        window.addEventListener('click', (e) => {
            if (e.target === reservaModal || e.target === confirmacionModal) {
                closeModals();
            }
        });
    }
    function closeModals() {
        reservaModal.style.display = 'none';
        confirmacionModal.style.display = 'none';
    }
    // Manejo de reservas
    async function handleReservaSubmit(e) {
        e.preventDefault(); // Prevenir recarga
        // Obtener datos del formulario
        const nombre = document.getElementById('nombre').value;
        const correo = document.getElementById('correo').value;
        const telefono = document.getElementById('telefono').value;
        const fecha = fechaInput.value;
        const horaEntrada = document.getElementById('hora_entrada').value;
        const horaSalida = document.getElementById('hora_salida').value;
        const servicio = servicioInput.value;
        // Validar hora
        if (horaSalida <= horaEntrada) {
            alert('La hora de salida debe ser posterior a la hora de entrada');
            return;
        }
        const clienteData = {
            nombre,
            correo,
            telefono,
            fecha,
            horaEntrada,
            horaSalida
        };
        // Intentar hacer la reserva
        const reservaExitosa = await confirmarReserva(servicio, clienteData);
        if (reservaExitosa) {
            // Actualizar modal de confirmación
            confServicio.textContent = servicio;
            confNombre.textContent = nombre;
            confFecha.textContent = fecha;
            confHoraEntrada.textContent = horaEntrada;
            confHoraSalida.textContent = horaSalida;
            confCodigo.textContent = codigoReserva;
            // Configurar WhatsApp
            const mensaje = `Hola, acabo de realizar una reserva para ${servicio} en Shumak Ware.%0A%0A` +
                            `*Código de Reserva:* ${codigoReserva}%0A` +
                            `*Nombre:* ${nombre}%0A` +
                            `*Fecha:* ${fecha}%0A` +
                            `*Hora de Entrada:* ${horaEntrada}%0A` +
                            `*Hora de Salida:* ${horaSalida}%0A%0A` +
                            `Quiero realizar el pago del 25% para confirmar mi reserva.`;
            whatsappBtn.href = `https://wa.me/51987957231?text=${encodeURIComponent(mensaje)}`;
            // Mostrar confirmación
            reservaModal.style.display = 'none';
            confirmacionModal.style.display = 'block';
            // Resetear formulario
            reservaForm.reset();
        }
    }
    async function confirmarReserva(servicio, clienteData) {
        try {
            const refServicio = db.ref(`services/${servicio}/clientes`);
            const snapshot = await refServicio.once('value');
            const reservas = snapshot.val() || {};
            // Validar disponibilidad
            if (!validarDisponibilidad(reservas, clienteData)) {
                alert("Pruebe otro horario");
                return false;
            }
            // Guardar la reserva
            const nuevaReservaRef = refServicio.push();
            codigoReserva = nuevaReservaRef.key; // Firebase genera un ID único
            await nuevaReservaRef.set(clienteData);
            return true;
        } catch (error) {
            console.error("Error en reserva:", error);
            return false;
        }
    }
    function validarDisponibilidad(reservas, { fecha, horaEntrada, horaSalida }) {
        const hoy = new Date();
        const entradaCliente = new Date(`${fecha}T${horaEntrada}`);
        const salidaCliente = new Date(`${fecha}T${horaSalida}`);
        // Verificar que la fecha sea hoy o en el futuro
        if (entradaCliente < hoy) {
            alert("No se puede reservar en una fecha pasada");
            return false;
        }
        // Convertir a minutos para facilitar comparación
        const entradaMin = entradaCliente.getTime();
        const salidaMin = salidaCliente.getTime();
        // Verificar solapamiento con reservas existentes
        for (const reservaId in reservas) {
            const reserva = reservas[reservaId];
            // Solo comparar si es la misma fecha
            if (reserva.fecha === fecha) {
                const entradaExistente = new Date(`${reserva.fecha}T${reserva.horaEntrada}`).getTime();
                const salidaExistente = new Date(`${reserva.fecha}T${reserva.horaSalida}`).getTime();
                // Comprobar solapamiento
                if (entradaMin < salidaExistente && salidaMin > entradaExistente) {
                    return false;
                }
            }
        }
        return true;
    }
    // Inicialización
    document.addEventListener('DOMContentLoaded', () => {
        initCarousel();
        initModals();
        reservaForm.addEventListener('submit', handleReservaSubmit);
    });
</script>
</body>
</html>
