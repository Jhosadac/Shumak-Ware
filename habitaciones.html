<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Habitaciones - Shumak Ware</title>

    <!--estilos-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Caveat&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">

    <!--libreria de firebase-->
    <script src="https://www.gstatic.com/firebasejs/7.20.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.20.0/firebase-database.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="main-header">
        <div class="header-wrap">
            <nav class="nav-header">
                <a href="index.html">Inicio</a>
                <div class="dropdown-restaurante">
                    <a href="restaurante.html" class="nav-link-restaurante">Restaurante</a>
                    <div class="dropdown-content-restaurante">
                        <a href="menu.html">Menú</a>
                        <a href="reserva-mesa.html">Reserva de Mesa</a>
                    </div>
                </div>
                <a href="servicios.html">Servicios</a>
                <a href="contacto.html">Contacto</a>
                <a href="habitaciones.html" class="active">Habitaciones</a>
            </nav>
        </div>
    </header>
    
    <!-- Barra de búsqueda -->
    <div class="search-bar">
        <div class="logo">
            <img src="assests/logo_final.png" alt="Shumak Ware Logo">
        </div>

        <div class="dates-range"> 
            <div class="fechas">
                <div class="search-field entrada" id="fechaEntrada">
                    <i class="fas fa-calendar-check"></i> 
                    <span id="entradaLabel">Entrada</span>
                </div>
            
                <div class="search-field salida" id="fechaSalida">
                    <i class="fas fa-calendar-check"></i> 
                    <span id="salidaLabel">Salida</span>
                </div>
            </div>
            
            <div class="dropdown-calendars" id="calendarsDropdown">
                <div class="triangle-container"><div class="triangle"></div></div>
                <div class="calendars-container">
                    <div class="calendar-details">
                        <div><b>Seleccione sus fechas</b> (opcional)</div>
                        <div class="number-nights" id="nightsCount">0 noches seleccionadas</div>
                    </div>
                    <div class="calendars-block">
                        <div class="calendar-block">
                            <div class="calendar-header">
                                <button class="prev-month-btn" id="prevMonthBtn"><i class="fas fa-chevron-left"></i></button>
                                <div class="month-label" id="entry-month-label">Julio</div>
                            </div>
                            <div class="calendar-grid" id="entry-calendar-grid"></div>
                        </div>

                        <div class="calendar-block">
                            <div class="calendar-header">
                                <div class="month-label" id="exit-month-label">Agosto</div>
                                <button class="next-month-btn" id="nextMonthBtn"><i class="fas fa-chevron-right"></i></button>
                            </div>
                            <div class="calendar-grid" id="exit-calendar-grid"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="dropdown">
            <button class="dropdown-btn">
                <i class="fas fa-bed"></i> <span>Todas</span>
                <i class="fas fa-chevron-down"></i>
            </button>
            <div class="dropdown-content">
                <div class="dropdown-option" data-type="all">Todas</div>
                <div class="dropdown-option" data-type="simple">Simple</div>
                <div class="dropdown-option" data-type="doble">Doble</div>
                <div class="dropdown-option" data-type="matrimonial">Matrimonial</div>
            </div>
        </div>
        <button class="apply-btn" id="aplicarBtn">Buscar</button>
    </div>

    <!-- Descripción -->
    <div class="hab-desc">
        <h2 class="hab-desc-title">Nuestras habitaciones</h2>
        <p>El alojamiento en el hotel Shumak Ware garantiza una estancia inolvidable. Disfruta de sus exclusivas habitaciones 
            completamente equipadas y aprovecha la multitud de actividades que ofrecemos.</p>
    </div>

    <!-- Grid de habitaciones -->
    <div class="rooms-grid">
        <!-- Habitación 1 -->
        <div class="room-card" id="1">
            <div class="room-img">
                <img src="assests/habitacion_1.jpg">
            </div>
            
            <div class="room-details">
                <h3 class="room-name">Simple</h3>
                <div class="room-price">S/.30 <span>/noche</span></div>
                
                <div class="room-features">
                    <div class="feature">
                        <i class="fas fa-bed"></i>
                        <span>1</span>
                    </div>
                    <div class="feature">
                        <i class="fas fa-user"></i>
                        <span>1 Persona</span>
                    </div>
                </div>
                
                <p class="room-description">Habitación acogedora con vista a las montañas, perfecta para viajeros individuales.</p>
                
                <div class="room-actions">
                    <button class="view-details-btn">Ver detalles</button>
                    <button class="add-to-cart-btn" data-id="1" data-name="Simple" data-price="30">Añadir</button>
                </div>
            </div>
        </div>

        <!-- Habitación 2 -->
        <div class="room-card" id="2">
            <div class="room-img">
                <img src="assests/habitacion_2.jpg">
            </div>
            
            <div class="room-details">
                <h3 class="room-name">Simple Premium</h3>
                <div class="room-price">S/.40 <span>/noche</span></div>
                
                <div class="room-features">
                    <div class="feature">
                        <i class="fas fa-bed"></i>
                        <span>1</span>
                    </div>
                    <div class="feature">
                        <i class="fas fa-user"></i>
                        <span>1 Persona</span>
                    </div>
                </div>
                
                <p class="room-description">Habitación con balcón privado y vista panorámica a la Cordillera Blanca.</p>
                
                <div class="room-actions">
                    <button class="view-details-btn">Ver detalles</button>
                    <button class="add-to-cart-btn" data-id="2" data-name="Simple Premium" data-price="40">Añadir</button>
                </div>
            </div>
        </div>

        <!-- Habitación 3 -->
        <div class="room-card" id="3">
            <div class="room-img">
                <img src="assests/habitacion_3.jpg">
            </div>
            
            <div class="room-details">
                <h3 class="room-name">Doble</h3>
                <div class="room-price">S/.50 <span>/noche</span></div>
                
                <div class="room-features">
                    <div class="feature">
                        <i class="fas fa-bed"></i>
                        <span>2</span>
                    </div>
                    <div class="feature">
                        <i class="fas fa-user"></i>
                        <span>2 Personas</span>
                    </div>
                </div>
                
                <p class="room-description">Amplia habitación con dos camas individuales, ideal para amigos o familiares.</p>
                
                <div class="room-actions">
                    <button class="view-details-btn">Ver detalles</button>
                    <button class="add-to-cart-btn" data-id="3" data-name="Doble" data-price="50">Añadir</button>
                </div>
            </div>
        </div>

        <!-- Habitación 4 -->
        <div class="room-card" id="4">
            <div class="room-img">
                <img src="assests/habitacion_1.jpg">
            </div>
            
            <div class="room-details">
                <h3 class="room-name">Doble Premium</h3>
                <div class="room-price">S/.60 <span>/noche</span></div>
                
                <div class="room-features">
                    <div class="feature">
                        <i class="fas fa-bed"></i>
                        <span>2</span>
                    </div>
                    <div class="feature">
                        <i class="fas fa-user"></i>
                        <span>2 Personas</span>
                    </div>
                </div>
                
                <p class="room-description">Habitación con terraza privada y vistas espectaculares a las montañas.</p>
                
                <div class="room-actions">
                    <button class="view-details-btn">Ver detalles</button>
                    <button class="add-to-cart-btn" data-id="4" data-name="Doble Premium" data-price="60">Añadir</button>
                </div>
            </div>
        </div>

        <!-- Habitación 5 -->
        <div class="room-card" id="5">
            <div class="room-img">
                <img src="assests/habitacion_2.jpg">
            </div>
            
            <div class="room-details">
                <h3 class="room-name">Matrimonial</h3>
                <div class="room-price">S/.70 <span>/noche</span></div>
                
                <div class="room-features">
                    <div class="feature">
                        <i class="fas fa-bed"></i>
                        <span>1</span>
                    </div>
                    <div class="feature">
                        <i class="fas fa-user"></i>
                        <span>2 Personas</span>
                    </div>
                </div>
                
                <p class="room-description">Romántica habitación con cama king size y baño con jacuzzi.</p>
                
                <div class="room-actions">
                    <button class="view-details-btn">Ver detalles</button>
                    <button class="add-to-cart-btn" data-id="5" data-name="Matrimonial" data-price="70">Añadir</button>
                </div>
            </div>
        </div>

        <!-- Habitación 6 -->
        <div class="room-card" id="6">
            <div class="room-img">
                <img src="assests/habitacion_3.jpg">
            </div>
            
            <div class="room-details">
                <h3 class="room-name">Matrimonial Premium</h3>
                <div class="room-price">S/.90 <span>/noche</span></div>
                
                <div class="room-features">
                    <div class="feature">
                        <i class="fas fa-bed"></i>
                        <span>1</span>
                    </div>
                    <div class="feature">
                        <i class="fas fa-user"></i>
                        <span>2 Personas</span>
                    </div>
                </div>
                
                <p class="room-description">Suite de lujo con balcón privado, chimenea y vistas panorámicas.</p>
                
                <div class="room-actions">
                    <button class="view-details-btn">Ver detalles</button>
                    <button class="add-to-cart-btn" data-id="6" data-name="Matrimonial Premium" data-price="90">Añadir</button>
                </div>
            </div>
        </div>
    </div>    

    <!-- Botón de carrito flotante -->
    <div class="cart-icon-container" id="cartIcon">
        <i class="fas fa-shopping-cart"></i>
        <span class="cart-count" id="cartCount">0</span>
    </div>

    <!-- Modal de carrito -->
    <div class="modal-hab" id="cartModal">
        <div class="modal-hab-content">
            <span class="close-btn" id="closeCartModal">&times;</span>
            
            <div class="modal-hab-header">
                <h2><i class="fas fa-shopping-cart"></i> Tu Carrito de Reservas</h2>
                <p>Revisa las habitaciones que has seleccionado</p>
            </div>
            
            <div class="reservation-summary">
                <h3>Resumen de Reservas</h3>
                <div id="cartItems">
                    <!-- Elementos del carrito se agregarán aquí dinámicamente -->
                </div>
                <div class="reservation-item">
                    <span class="reservation-label">Total:</span>
                    <span class="reservation-value" style="color: var(--turquesa); font-weight: 700; font-size: 1.2rem;" id="cartTotal">S/ 0.00</span>
                </div>
            </div>
            
            <button class="submit-btn" id="reserveNowBtn">
                <i class="fas fa-check-circle"></i> Reservar ahora
            </button>
        </div>
    </div>

    <!-- Modal de reserva -->
    <div class="modal-hab" id="reservationModal">
        <div class="modal-hab-content">
            <span class="close-btn" id="closeModal">&times;</span>
            
            <div class="modal-hab-header">
                <h2><i class="fas fa-calendar-check"></i> Completa tu reserva</h2>
                <p>Por favor ingresa tus datos para finalizar la reserva</p>
            </div>
            
            <div class="reservation-summary" id="reservationSummary">
                <!-- Resumen de reserva se agregará aquí dinámicamente -->
            </div>
            
            <form id="reservationForm">
                <div class="form-group-hab">
                    <label for="nombre"><i class="fas fa-user"></i> Nombre completo</label>
                    <input type="text" id="nombre" placeholder="Ingresa tu nombre completo" required>
                </div>
                
                <div class="form-group-hab">
                    <label for="correo"><i class="fas fa-envelope"></i> Correo electrónico</label>
                    <input type="email" id="correo" placeholder="Ingresa tu correo electrónico" required>
                </div>
                
                <div class="form-group-hab">
                    <label for="telefono"><i class="fas fa-phone"></i> Teléfono</label>
                    <input type="tel" id="telefono" placeholder="Ingresa tu número telefónico" required>
                </div>
                
                <button type="submit" class="submit-btn" id="submitReservation">
                    <i class="fas fa-check-circle"></i> Confirmar Reserva
                </button>
            </form>
        </div>
    </div>
    
    <!-- Modal de confirmación -->
    <div class="modal-hab" id="confirmationModal">
        <div class="modal-hab-content">
            <div class="confirmation">
                <i class="fas fa-check-circle"></i>
                <h2>¡Reserva Confirmada!</h2>
                <p>Tu reserva ha sido registrada exitosamente.</p>
                <p>ID de reserva: <strong id="reservationId">RES-2023-001</strong></p>
                <p>Por favor envía el comprobante de pago por WhatsApp para finalizar el proceso.</p>
                
                <button class="whatsapp-btn-hab" id="whatsappBtn">
                    <i class="fab fa-whatsapp"></i> Enviar Comprobante por WhatsApp
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-grid">
                <div class="footer-section">
                    <h3>Acerca de Nosotros</h3>
                    <p>Shumak Ware es un hotel-restaurante campestre que combina la naturaleza con la comodidad, ofreciendo experiencias únicas en el corazón de la Cordillera Blanca.</p>
                </div>
                <div class="footer-section">
                    <h3>Enlaces Rápidos</h3>
                    <ul>
                        <li><a href="index.html">Inicio</a></li>
                        <li><a href="habitaciones.html">Habitaciones</a></li>
                        <li><a href="restaurante.html">Restaurante</a></li>
                        <li><a href="servicios.html">Servicios</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Contacto</h3>
                    <ul>
                        <li><i class="fas fa-phone"></i> +51 912 345 678</li>
                        <li><i class="fas fa-envelope"></i> shumakware@gmail.com</li>
                        <li><i class="fas fa-map-marker-alt"></i> Anta, Huaraz, Ancash</li>
                        <li><i class="fab fa-facebook"></i> facebook.com/shumakware</li>
                        <li><i class="fab fa-instagram"></i> instagram.com/shumakware</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                &copy; 2023 Shumak Ware. Todos los derechos reservados.
            </div>
        </div>
    </footer>

    <script>
        // Variables globales
        let cart = [];
        let selectedStartDate = null;
        let selectedEndDate = null;
        let currentMonth = new Date();
        
        // Días de la semana
        const weekDays = ['Dom', 'Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb'];
        
        // Nombres de los meses
        const monthNames = [
            'Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
            'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'
        ];
        
        // Función para inicializar la página
        function initPage() {
            // Generar calendarios
            renderCalendars();
            
            // Configurar eventos
            setupEventListeners();
            
            // Actualizar contador de carrito
            updateCartCount();
        }
        
        // Función para generar los calendarios
        function renderCalendars() {
            // Actualizar etiquetas de mes
            document.getElementById('entry-month-label').textContent = monthNames[currentMonth.getMonth()];
            
            // Calcular mes siguiente
            const nextMonth = new Date(currentMonth);
            nextMonth.setMonth(nextMonth.getMonth() + 1);
            document.getElementById('exit-month-label').textContent = monthNames[nextMonth.getMonth()];
            
            // Generar calendario de entrada
            renderCalendar('entry-calendar-grid', currentMonth.getFullYear(), currentMonth.getMonth());
            
            // Generar calendario de salida (mes siguiente)
            renderCalendar('exit-calendar-grid', nextMonth.getFullYear(), nextMonth.getMonth());
        }
        
        // Función para generar un calendario
        function renderCalendar(containerId, year, month) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            // Generar encabezados de días
            for (let i = 0; i < 7; i++) {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'calendar-day-header';
                dayHeader.textContent = weekDays[i];
                container.appendChild(dayHeader);
            }
            
            // Obtener primer día del mes y cantidad de días
            const firstDay = new Date(year, month, 1);
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            // Días del mes anterior para completar la semana
            const startDayOfWeek = firstDay.getDay();
            
            // Crear días del calendario
            for (let i = 0; i < startDayOfWeek; i++) {
                const day = document.createElement('div');
                day.className = 'calendar-day disabled';
                day.textContent = '';
                container.appendChild(day);
            }
            
            // Crear días del mes actual
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            for (let i = 1; i <= daysInMonth; i++) {
                const day = document.createElement('div');
                day.className = 'calendar-day';
                day.textContent = i;
                day.dataset.date = `${year}-${month + 1}-${i}`;
                
                const dateObj = new Date(year, month, i);
                dateObj.setHours(0, 0, 0, 0);
                
                // Deshabilitar días pasados
                if (dateObj < today) {
                    day.classList.add('disabled');
                }
                
                // Deshabilitar días anteriores a la fecha de entrada seleccionada
                if (selectedStartDate && dateObj < selectedStartDate) {
                    day.classList.add('disabled');
                }
                
                // Marcar días seleccionados
                if (selectedStartDate && isSameDay(dateObj, selectedStartDate)) {
                    day.classList.add('selected');
                }
                
                if (selectedEndDate && isSameDay(dateObj, selectedEndDate)) {
                    day.classList.add('selected');
                }
                
                // Marcar rango si existe
                if (selectedStartDate && selectedEndDate) {
                    if (dateObj > selectedStartDate && dateObj < selectedEndDate) {
                        day.classList.add('in-range');
                    }
                }
                
                container.appendChild(day);
            }
        }
        
        // Función para manejar clic en día del calendario
        function handleDayClick(dayElement) {
            if (dayElement.classList.contains('disabled')) return;
            
            const dateString = dayElement.dataset.date;
            const dateParts = dateString.split('-');
            const clickedDate = new Date(dateParts[0], dateParts[1] - 1, dateParts[2]);
            clickedDate.setHours(0, 0, 0, 0);
            
            // Si no hay fecha seleccionada o ya hay dos fechas seleccionadas
            if (!selectedStartDate || (selectedStartDate && selectedEndDate)) {
                // Reiniciar selección
                selectedStartDate = clickedDate;
                selectedEndDate = null;
                
                // Actualizar UI
                document.getElementById('entradaLabel').textContent = formatDate(selectedStartDate);
                document.getElementById('salidaLabel').textContent = 'Salida';
                document.getElementById('nightsCount').textContent = '0 noches seleccionadas';
            } 
            // Si ya hay fecha de inicio seleccionada
            else {
                // Validar que la fecha de salida sea posterior a la de entrada
                if (clickedDate <= selectedStartDate) {
                    alert('La fecha de salida debe ser posterior a la fecha de entrada');
                    return;
                }
                
                selectedEndDate = clickedDate;
                
                // Calcular noches
                const diffTime = Math.abs(selectedEndDate - selectedStartDate);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 
                
                // Actualizar UI
                document.getElementById('salidaLabel').textContent = formatDate(selectedEndDate);
                document.getElementById('nightsCount').textContent = `${diffDays} noches seleccionadas`;
            }
            
            // Actualizar calendarios
            renderCalendars();
        }
        
        // Función para manejar hover en días del calendario
        function handleDayHover(dayElement) {
            if (!selectedStartDate || selectedEndDate || dayElement.classList.contains('disabled')) return;
            
            const dateString = dayElement.dataset.date;
            const dateParts = dateString.split('-');
            const hoverDate = new Date(dateParts[0], dateParts[1] - 1, dateParts[2]);
            hoverDate.setHours(0, 0, 0, 0);
            
            // Limpiar resaltados anteriores
            document.querySelectorAll('.calendar-day.highlight').forEach(day => {
                day.classList.remove('highlight');
            });
            
            // Determinar rango para resaltar
            const start = selectedStartDate < hoverDate ? selectedStartDate : hoverDate;
            const end = selectedStartDate < hoverDate ? hoverDate : selectedStartDate;
            
            // Resaltar todos los días en el rango
            const allDays = document.querySelectorAll('.calendar-day:not(.disabled)');
            allDays.forEach(day => {
                const dateString = day.dataset.date;
                if (!dateString) return;
                
                const dateParts = dateString.split('-');
                const date = new Date(dateParts[0], dateParts[1] - 1, dateParts[2]);
                date.setHours(0, 0, 0, 0);
                
                if (date > start && date < end) {
                    day.classList.add('highlight');
                }
            });
        }
        
        // Función para configurar eventos
        function setupEventListeners() {
            // Mostrar/ocultar calendarios
            document.querySelectorAll('.search-field').forEach(field => {
                field.addEventListener('click', () => {
                    document.getElementById('calendarsDropdown').classList.toggle('show');
                });
            });
            
            // Ocultar calendarios al hacer clic fuera
            document.addEventListener('click', (e) => {
                const calendarsDropdown = document.getElementById('calendarsDropdown');
                const isClickInside = calendarsDropdown.contains(e.target) || 
                                     e.target.closest('.search-field');
                
                if (!isClickInside) {
                    calendarsDropdown.classList.remove('show');
                }
            });
            
            // Eventos para días del calendario (usando delegación)
            document.getElementById('entry-calendar-grid').addEventListener('click', (e) => {
                if (e.target.classList.contains('calendar-day') && !e.target.classList.contains('disabled')) {
                    handleDayClick(e.target);
                }
            });
            
            document.getElementById('exit-calendar-grid').addEventListener('click', (e) => {
                if (e.target.classList.contains('calendar-day') && !e.target.classList.contains('disabled')) {
                    handleDayClick(e.target);
                }
            });
            
            // Navegación entre meses
            document.getElementById('prevMonthBtn').addEventListener('click', () => {
                currentMonth.setMonth(currentMonth.getMonth() - 1);
                renderCalendars();
            });
            
            document.getElementById('nextMonthBtn').addEventListener('click', () => {
                currentMonth.setMonth(currentMonth.getMonth() + 1);
                renderCalendars();
            });
            
            // Botón de aplicar búsqueda
            document.getElementById('aplicarBtn').addEventListener('click', applySearch);
            
            // Botones de añadir al carrito
            document.querySelectorAll('.add-to-cart-btn').forEach(btn => {
                btn.addEventListener('click', addToCart);
            });
            
            // Botones de ver detalles
            document.querySelectorAll('.view-details-btn').forEach(btn => {
                btn.addEventListener('click', viewDetails);
            });
            
            // Botón de carrito
            document.getElementById('cartIcon').addEventListener('click', showCartModal);
            
            // Cerrar modal de carrito
            document.getElementById('closeCartModal').addEventListener('click', () => {
                document.getElementById('cartModal').classList.remove('show');
            });
            
            // Botón de reservar ahora en el carrito
            document.getElementById('reserveNowBtn').addEventListener('click', showReservationModal);
            
            // Cerrar modal de reserva
            document.getElementById('closeModal').addEventListener('click', () => {
                document.getElementById('reservationModal').classList.remove('show');
            });
            
            // Enviar formulario de reserva
            document.getElementById('reservationForm').addEventListener('submit', submitReservation);
            
            // Botón de WhatsApp
            document.getElementById('whatsappBtn').addEventListener('click', () => {
                alert('Enviando a WhatsApp...');
            });
        }
        
        // Funciones de utilidad
        function formatDate(date) {
            if (!date) return '';
            const day = date.getDate().toString().padStart(2, '0');
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const year = date.getFullYear();
            return `${day}/${month}/${year}`;
        }
        
        function isSameDay(date1, date2) {
            return date1.getFullYear() === date2.getFullYear() &&
                   date1.getMonth() === date2.getMonth() &&
                   date1.getDate() === date2.getDate();
        }
        
        // Función para aplicar búsqueda
        function applySearch() {
            alert('Búsqueda aplicada');
            document.getElementById('calendarsDropdown').classList.remove('show');
        }
        
        // Función para añadir al carrito
        function addToCart(e) {
            const button = e.target;
            const roomId = button.getAttribute('data-id');
            const roomName = button.getAttribute('data-name');
            const roomPrice = parseFloat(button.getAttribute('data-price'));
            
            // Verificar si ya está en el carrito
            const existingItem = cart.find(item => item.id === roomId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    id: roomId,
                    name: roomName,
                    price: roomPrice,
                    quantity: 1
                });
            }
            
            // Actualizar contador de carrito
            updateCartCount();
            
            // Mostrar confirmación
            alert(`Se ha añadido: ${roomName} al carrito`);
        }
        
        // Función para actualizar contador de carrito
        function updateCartCount() {
            const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
            document.getElementById('cartCount').textContent = totalItems;
        }
        
        // Función para mostrar modal de carrito
        function showCartModal() {
            const cartItemsContainer = document.getElementById('cartItems');
            cartItemsContainer.innerHTML = '';
            
            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '<p class="empty-cart">Tu carrito está vacío</p>';
                document.getElementById('cartTotal').textContent = 'S/ 0.00';
                document.getElementById('reserveNowBtn').disabled = true;
            } else {
                let total = 0;
                
                cart.forEach(item => {
                    const itemTotal = item.price * item.quantity;
                    total += itemTotal;
                    
                    const itemElement = document.createElement('div');
                    itemElement.className = 'reservation-item';
                    itemElement.innerHTML = `
                        <span class="reservation-label">${item.name} x ${item.quantity}</span>
                        <span class="reservation-value">S/ ${itemTotal.toFixed(2)}</span>
                    `;
                    cartItemsContainer.appendChild(itemElement);
                });
                
                document.getElementById('cartTotal').textContent = `S/ ${total.toFixed(2)}`;
                document.getElementById('reserveNowBtn').disabled = false;
            }
            
            document.getElementById('cartModal').classList.add('show');
        }
        
        // Función para mostrar modal de reserva
        function showReservationModal() {
            const reservationSummary = document.getElementById('reservationSummary');
            reservationSummary.innerHTML = '';
            
            if (cart.length === 0) return;
            
            let total = 0;
            
            // Crear encabezado
            const header = document.createElement('h3');
            header.textContent = 'Resumen de Reserva';
            reservationSummary.appendChild(header);
            
            // Agregar habitaciones
            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                const itemElement = document.createElement('div');
                itemElement.className = 'reservation-item';
                itemElement.innerHTML = `
                    <span class="reservation-label">Habitación:</span>
                    <span class="reservation-value">${item.name} x ${item.quantity}</span>
                `;
                reservationSummary.appendChild(itemElement);
            });
            
            // Agregar fechas si están seleccionadas
            if (selectedStartDate && selectedEndDate) {
                const diffTime = Math.abs(selectedEndDate - selectedStartDate);
                const nights = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                const datesElement = document.createElement('div');
                datesElement.className = 'reservation-item';
                datesElement.innerHTML = `
                    <span class="reservation-label">Fechas:</span>
                    <span class="reservation-value">${formatDate(selectedStartDate)} - ${formatDate(selectedEndDate)} (${nights} noches)</span>
                `;
                reservationSummary.appendChild(datesElement);
            }
            
            // Agregar total
            const totalElement = document.createElement('div');
            totalElement.className = 'reservation-item';
            totalElement.innerHTML = `
                <span class="reservation-label">Total:</span>
                <span class="reservation-value" style="color: var(--turquesa); font-weight: 700;">S/ ${total.toFixed(2)}</span>
            `;
            reservationSummary.appendChild(totalElement);
            
            document.getElementById('cartModal').classList.remove('show');
            document.getElementById('reservationModal').classList.add('show');
        }
        
        // Función para enviar reserva
        function submitReservation(e) {
            e.preventDefault();
            
            // Generar ID de reserva
            const reservationId = 'RES-' + Math.floor(100000 + Math.random() * 900000);
            document.getElementById('reservationId').textContent = reservationId;
            
            // Mostrar modal de confirmación
            document.getElementById('reservationModal').classList.remove('show');
            document.getElementById('confirmationModal').classList.add('show');
            
            // Limpiar carrito
            cart = [];
            updateCartCount();
        }
        
        // Función para ver detalles de habitación
        function viewDetails(e) {
            const roomCard = e.target.closest('.room-card');
            const roomId = roomCard.id;
            alert(`Mostrando detalles de la habitación ${roomId}`);
        }
        
        // Inicializar la página cuando se cargue
        document.addEventListener('DOMContentLoaded', initPage);
    </script>
</body>
</html>
